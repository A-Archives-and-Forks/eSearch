# OCR

使用 PaddleOCR 实现文字识别。为了在 web（Electron）上使用，需要把 PaddleOCR 的 Python 代码转换为 JavaScript，同时把模型转换为[ONNX](https://onnx.ai/)格式。

原本打算使用 Paddle.js，但当时支持有限，所以代码是直接从 Python 中翻译过来的，一边调试一边学习，解码部分参考了 Paddle.js 的实现。后来 LLM 横空出世，一些图片处理功能在以前没来得及实现的都使用 AI 翻译了。

## PaddleOCR 分析

基于 v3 版本，尽管现在的模型是 v4。

文字识别分为文字检测（rec）和文字识别（det）（目前不考虑方向、排版等）。

文字检测获取文字坐标（Paddle 里按行），裁切后送入文字识别模型。

### 文字检测

结果是二值图，每个像素点为 0 或 1，代表是否有文字。通过 opencv 查找轮廓，确定边框。

### 文字识别

输入是裁切后的图像，输出数组的一级是按字的数组，二级是字典索引对应的概率。字典一字一行，行号-1 是每个字的索引。输出的概率列中，对应了每个字与图片中文字的相似程度，找到概率最大的索引，对应的文字就是结果文字。

<!-- todo 空格优化 -->
